version: '3.3'

services:
  app:
    image: pizza-django
    volumes:
      - ../:/usr/src/app
    expose:
      - "8000"
    ports:
      - "8000:8000"
    links:
      - postgres
    entrypoint: container/entry_point.sh
  postgres:
    image: postgres:latest
    ports:
      - "5432:5432"
    volumes:
      - pgdata:/var/lib/postgresql/data
  payment-server:
     build:
       context: ../payment-server
       dockerfile: Dockerfile
     environment:
         - HTTP_PORT=9000
         - ENVIONRMENT=production
         - APP_DIR=usr/src/app
     volumes:
       - ../payment-server:/usr/src/app
     restart: always
     expose:
       - "9000"
     ports:
       - "9000:9000"
volumes:
    pgdata:
